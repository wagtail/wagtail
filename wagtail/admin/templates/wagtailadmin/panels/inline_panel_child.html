{% load i18n wagtailadmin_tags %}

{% fragment as id %}inline_child_{{ child.form.prefix }}{% endfragment %}
{% fragment as panel_id %}{{ id }}-panel{% endfragment %}
<div id="{{ id }}" data-w-formset-target="child" data-contentpath-disabled data-w-orderable-target="item" data-w-orderable-item-id="{{ id }}">
    {% fragment as header_controls %}
        {% if can_order %}
            <button type="button" class="button button--icon text-replace white" data-w-orderable-target="up" data-action="w-orderable#up" title="{% trans 'Move up' %}">
                {% icon name="arrow-up" %}
            </button>
            <button type="button" class="button button--icon text-replace white" data-w-orderable-target="down" data-action="w-orderable#down" title="{% trans 'Move down' %}">
                {% icon name="arrow-down" %}
            </button>
            <button type="button" class="button button--icon text-replace white" data-w-orderable-target="handle" title="{% trans 'Drag' %}">
                {% icon name="grip" %}
            </button>
        {% endif %}
        <button type="button" class="button button--icon text-replace white" data-action="w-formset#delete" data-w-formset-target="delete" title="{% trans 'Delete' %}">
            {% icon name="bin" %}
        </button>
    {% endfragment %}
    {% fragment as heading %}
        {{ self.label|capfirst }}<span data-w-formset-target="count"></span>
    {% endfragment %}
    {% panel id=panel_id heading=heading heading_size="label" heading_level="3" header_controls=header_controls %}
        {% if child.form.non_field_errors %}
            <ul>
                {% for error in child.form.non_field_errors %}
                    <li class="error-message">
                        <span>{{ error|escape }}</span>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
        {{ child.render_form_content }}
    {% endpanel %}
</div>
