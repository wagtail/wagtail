{% load i18n wagtailadmin_tags %}

{% if not page_perms %}
    {% page_permissions page as page_perms %}
{% endif %}

{% if page.locked and page_perms.can_unlock %}
    {% url 'wagtailadmin_pages:unlock' page.id as form_action %}
{% elif not page.locked and page_perms.can_lock %}
    {% url 'wagtailadmin_pages:lock' page.id as form_action %}
{% endif %}

<form action="{{ form_action }}" method="POST" class="lock-indicator {{ page.locked|yesno:'locked,unlocked' }}">
    {% trans "Edit lock" %}

    {% csrf_token %}
    <input type="hidden" name="next" value="{% url 'wagtailadmin_pages:edit' page.id %}" />
    <button
        type="submit"
        class="status-tag {{ page.locked|yesno:'primary,secondary' }}{% if not form_action %} disabled{% endif %}"
        aria-label="{% if page_locked %}{% if user_can_unlock %}{% trans 'Remove editor lock. Current status: Locked' %}{% else %}{% trans 'Current status: Locked' %}{% endif %}{% else %}{% trans 'Apply editor lock. Current status: Unlocked' %}{% endif %}">
        {% if page_locked %}
            {% trans "Locked" %}
        {% elif user_has_lock %}
            {% trans "Locked by you" %}
        {% else %}
            {% trans "Unlocked" %}
        {% endif %}
    </button>
</form>
