{% load wagtailadmin_tags i18n %}
{% if workflow_state %}
    {% with workflow_state.workflow as workflow %}

    <h2>
        <a href="{% url 'wagtailadmin_pages:workflow_history_detail' page.id workflow_state.id %}">
            {{ workflow.name }}
        </a>
    </h2>

    {% if current_task_state %}
        {% with current_task_state.task as task %}

        {% if current_task_number %}
            {% blocktrans with workflow_tasks|length as total_tasks %} Task {{ current_task_number }} of {{ total_tasks }}{% endblocktrans %}: {{ task.name }}
        {% else %}
            {% trans 'Task' %}: {{ task.name }}
        {% endif %}

        {% endwith %}
    {% endif %}

    <div>
        {% trans 'Approved task' as approved_title %}
        {% trans 'Incomplete task' as incomplete_title %}
        {% for task in workflow_tasks %}
            <span data-wagtail-tooltip="{{ task.name }}: {{ task.status_display }}">
                {% if task.status == 'approved' %}
                    {% icon "success" title=approved_title %}
                {% else %}
                    {% icon "radio-empty" title=incomplete_title %}
                {% endif %}
            </span>
        {% endfor %}
    </div>

    {% endwith %}

    <a href="{% url 'wagtailadmin_pages:workflow_history' page.id %}">
        {% trans "Workflow history" %}
    </a>
{% endif %}
